{"version":3,"sources":["components/EditPost.js"],"names":["baseURL","process","REACT_APP_BASEURL","EditPost","props","state","title","body","author","date","isLoggedIn","handleChange","bind","handleSubmit","handleEditorChange","axios","get","this","match","params","id","then","post","setState","data","comments","catch","err","console","error","sessionStorage","getItem","event","editor","getData","target","name","value","preventDefault","document","querySelector","style","display","sanitizedData","sanitizeHtml","editedPost","res","window","location","className","role","onSubmit","type","onChange","required","ClassicEditor","config","toolbar","onClick","data-dismiss","aria-label","aria-hidden","Component"],"mappings":"6RAMMA,EAAUC,mIAAYC,mBAAqB,wBAE3CC,E,kDACF,WAAYC,GAAQ,IAAD,8BACf,cAAMA,IAEDC,MAAQ,CACTC,MAAO,GACPC,KAAM,GACNC,OAAQ,GACRC,KAAM,GACNC,YAAY,GAGhB,EAAKC,aAAe,EAAKA,aAAaC,KAAlB,gBACpB,EAAKC,aAAe,EAAKA,aAAaD,KAAlB,gBACpB,EAAKE,mBAAqB,EAAKA,mBAAmBF,KAAxB,gBAbX,E,qDAgBnB,WAAqB,IAAD,OAChBG,IACKC,IADL,UACYhB,EADZ,yBACoCiB,KAAKb,MAAMc,MAAMC,OAAOC,KACvDC,MAAK,SAACC,GACH,EAAKC,SAAS,CACVjB,MAAOgB,EAAKE,KAAKlB,MACjBC,KAAMe,EAAKE,KAAKjB,KAChBC,OAAQc,EAAKE,KAAKhB,OAClBC,KAAMa,EAAKE,KAAKf,KAChBgB,SAAUH,EAAKE,KAAKC,cAG3BC,OAAM,SAACC,GAAD,OAASC,QAAQC,MAAMF,MAEW,SAAzCG,eAAeC,QAAQ,eACvBd,KAAKM,SAAS,CAAEb,YAAY,M,gCAIpC,SAAmBsB,EAAOC,GACtBhB,KAAKM,SAAS,CAAEhB,KAAM0B,EAAOC,c,0BAGjC,SAAaF,GACT,MAAwBA,EAAMG,OAAtBC,EAAR,EAAQA,KAAMC,EAAd,EAAcA,MAEdpB,KAAKM,SAAL,eACKa,EAAOC,M,0BAIhB,SAAaL,GAAQ,IAAD,OAChBA,EAAMM,iBAGNC,SAASC,cAAc,sBAAsBC,MAAMC,QAAU,UAE7D,IAAMC,EAAgBC,IAAa3B,KAAKZ,MAAME,MAC9CU,KAAKM,SAAS,CAAEhB,KAAMoC,IAEtB,IAAME,EAAa,CACfvC,MAAOW,KAAKZ,MAAMC,MAClBE,OAAQS,KAAKZ,MAAMG,OACnBD,KAAMU,KAAKZ,MAAME,KACjBE,KAAMQ,KAAKZ,MAAMI,KACjBgB,SAAUR,KAAKZ,MAAMoB,UAGzBV,IACKO,KADL,UAEWtB,EAFX,8BAEwCiB,KAAKb,MAAMc,MAAMC,OAAOC,IACxDyB,GAEHxB,MAEG,SAACyB,GAAD,OACKC,OAAOC,SAAP,iBAA4B,EAAK5C,MAAMc,MAAMC,OAAOC,OAE5DM,OAAM,SAACC,GAAD,OAASC,QAAQC,MAAMF,Q,oBAGtC,WACI,OAAIV,KAAKZ,MAAMK,WAEP,6BAEI,yBACIuC,UAAU,oBACVR,MAAO,CAAEC,QAAS,SAElB,yBAAKO,UAAU,iBAAiBC,KAAK,UACjC,0BAAMD,UAAU,WAAhB,gBAGR,yBAAKA,UAAU,aACX,6CACkB,0BAAMA,UAAU,aAAhB,MAElB,0BAAME,SAAUlC,KAAKJ,cACjB,yBAAKoC,UAAU,cACX,2BAAOA,UAAU,cAAjB,WACA,2BACIA,UAAU,0BACVG,KAAK,OACLhB,KAAK,QACLC,MAAOpB,KAAKZ,MAAMC,MAClB+C,SAAUpC,KAAKN,aACf2C,UAAQ,KAIhB,6BACI,kBAAC,IAAD,CACIrB,OAAQsB,IACR/B,KAAMP,KAAKZ,MAAME,KACjB8C,SAAUpC,KAAKH,mBACf0C,OAAQ,CACJC,QAAS,CACL,UACA,IACA,OACA,SACA,OACA,eACA,eACA,IACA,aACA,aACA,OACA,YAKhB,6BACA,yBAAKR,UAAU,cACX,2BACIG,KAAK,SACLf,MAAM,cACNY,UAAU,uCAS9B,yBACIA,UAAU,sBACVC,KAAK,QACLQ,QAAS,kBAAOX,OAAOC,SAAW,WAHtC,uCAMI,4BACII,KAAK,SACLH,UAAU,QACVU,eAAa,QACbC,aAAW,SAEX,0BAAMC,cAAY,OAAOZ,UAAU,eAAnC,OACY,W,GA9Jba,aAuKR3D,a","file":"static/js/8.0cdb9cfc.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport CKEditor from \"@ckeditor/ckeditor5-react\";\nimport ClassicEditor from \"@ckeditor/ckeditor5-build-classic\";\nimport sanitizeHtml from \"sanitize-html\";\n\nconst baseURL = process.env.REACT_APP_BASEURL || \"http://localhost:5000\";\n\nclass EditPost extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            title: \"\",\n            body: \"\",\n            author: \"\",\n            date: \"\",\n            isLoggedIn: false,\n        };\n\n        this.handleChange = this.handleChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handleEditorChange = this.handleEditorChange.bind(this);\n    }\n\n    componentDidMount() {\n        axios\n            .get(`${baseURL}/server/posts/${this.props.match.params.id}`)\n            .then((post) => {\n                this.setState({\n                    title: post.data.title,\n                    body: post.data.body,\n                    author: post.data.author,\n                    date: post.data.date,\n                    comments: post.data.comments,\n                });\n            })\n            .catch((err) => console.error(err));\n\n        if (sessionStorage.getItem(\"isLoggedIn\") === \"true\") {\n            this.setState({ isLoggedIn: true });\n        }\n    }\n\n    handleEditorChange(event, editor) {\n        this.setState({ body: editor.getData() });\n    }\n\n    handleChange(event) {\n        const { name, value } = event.target;\n\n        this.setState({\n            [name]: value,\n        });\n    }\n\n    handleSubmit(event) {\n        event.preventDefault();\n\n        // Display a spinner until the post is submitted\n        document.querySelector(\".spinner-container\").style.display = \"flexbox\";\n\n        const sanitizedData = sanitizeHtml(this.state.body);\n        this.setState({ body: sanitizedData });\n\n        const editedPost = {\n            title: this.state.title,\n            author: this.state.author,\n            body: this.state.body,\n            date: this.state.date,\n            comments: this.state.comments,\n        };\n\n        axios\n            .post(\n                `${baseURL}/server/posts/edit/${this.props.match.params.id}`,\n                editedPost\n            )\n            .then(\n                // redirect to SHOW page\n                (res) =>\n                    (window.location = `/posts/${this.props.match.params.id}`)\n            )\n            .catch((err) => console.error(err));\n    }\n\n    render() {\n        if (this.state.isLoggedIn) {\n            return (\n                <div>\n                    {/* A spinner to indicate loading until new post is submitted */}\n                    <div\n                        className=\"spinner-container\"\n                        style={{ display: \"none\" }}\n                    >\n                        <div className=\"spinner-border\" role=\"status\">\n                            <span className=\"sr-only\">Loading...</span>\n                        </div>\n                    </div>\n                    <div className=\"edit-post\">\n                        <h1>\n                            Edit Blog Post<span className=\"full-stop\">.</span>\n                        </h1>\n                        <form onSubmit={this.handleSubmit}>\n                            <div className=\"form-group\">\n                                <label className=\"edit-title\">Title: </label>\n                                <input\n                                    className=\"form-control edit-title\"\n                                    type=\"text\"\n                                    name=\"title\"\n                                    value={this.state.title}\n                                    onChange={this.handleChange}\n                                    required\n                                />\n                            </div>\n\n                            <div>\n                                <CKEditor\n                                    editor={ClassicEditor}\n                                    data={this.state.body}\n                                    onChange={this.handleEditorChange}\n                                    config={{\n                                        toolbar: [\n                                            \"Heading\",\n                                            \"|\",\n                                            \"Bold\",\n                                            \"Italic\",\n                                            \"Link\",\n                                            \"NumberedList\",\n                                            \"BulletedList\",\n                                            \"|\",\n                                            \"BlockQuote\",\n                                            \"MediaEmbed\",\n                                            \"Undo\",\n                                            \"Redo\",\n                                        ],\n                                    }}\n                                />\n                            </div>\n                            <br />\n                            <div className=\"form-group\">\n                                <input\n                                    type=\"submit\"\n                                    value=\"Submit Post\"\n                                    className=\"btn btn-outline-primary btn-lg\"\n                                />\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            );\n        } else {\n            return (\n                <div\n                    className=\"alert alert-warning\"\n                    role=\"alert\"\n                    onClick={() => (window.location = \"/login\")}\n                >\n                    You need to login to edit your post!\n                    <button\n                        type=\"button\"\n                        className=\"close\"\n                        data-dismiss=\"alert\"\n                        aria-label=\"Close\"\n                    >\n                        <span aria-hidden=\"true\" className=\"alert-close\">\n                            &times;{\" \"}\n                        </span>\n                    </button>\n                </div>\n            );\n        }\n    }\n}\n\nexport default EditPost;\n"],"sourceRoot":""}